<div id="header">

# <span class="image image-doc-icon">![Merge rows (diff) transform Icon](../assets/images/transforms/icons/mergerows.svg)</span> Merge rows (diff)

</div>

<div id="content">

<div id="preamble">

<div class="sectionbody">

<table>
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="content">
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Merge Rows (Diff) transform compares and merges rows between two data streams called <strong>Reference</strong> (previous data) and <strong>Compare</strong> (new data), adding a flag to each row.</p>
</div>
</div>
</div>
</div></td>
<td><div class="content">
<div class="sect1">
<h2 id="_supported_engines">Supported Engines</h2>
<div class="sectionbody">
<table>
<tbody>
<tr class="odd">
<td><p>Hop Engine</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/check_mark.svg" alt="Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="even">
<td><p>Spark</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/question_mark.svg" alt="Maybe Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="odd">
<td><p>Flink</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/question_mark.svg" alt="Maybe Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="even">
<td><p>Dataflow</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/question_mark.svg" alt="Maybe Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div></td>
</tr>
</tbody>
</table>

</div>

</div>

<div class="sect1">

## Usage

<div class="sectionbody">

<div class="paragraph">

This transform is useful for comparing data collected at two different times.

</div>

<div class="paragraph">

For example, the source system of your data warehouse might not contain a timestamp of the last data update.

</div>

<div class="paragraph">

You could use this transform to compare the two data streams and merge the dates and timestamps in the rows.

</div>

<div class="paragraph">

Based on key fields and comparison fields, this transform merges reference rows with compare rows and creates merged output rows.

</div>

<div class="paragraph">

A flag in each row indicates how the values were compared and merged. The possible flag values are:

</div>

<div class="ulist">

  - **identical**: The key was found in both rows, and the compared values are identical.

  - **changed**: The key was found in both rows, but one or more compared values are different.

  - **new**: The key was not found in the reference rows.

  - **deleted**: The key was not found in the compare rows.

</div>

<div class="paragraph">

If the row’s flag is **identical** or **deleted**, the merged output row is based on the reference row.

</div>

<div class="paragraph">

If the flag is **new** or **changed**, the merged output row is based on the compare row.

</div>

<div class="paragraph">

You can also send the merged and flagged rows to a subsequent transform in your pipeline, such as [Switch-Case](pipeline/transforms/switchcase.2QZH737kHN) or [Synchronize after merge](pipeline/transforms/synchronizeaftermerge.2QZH737kHN). In the subsequent transform, you can use the flag field generated by **Merge rows (diff)** to control updates/inserts/deletes on a target table.

</div>

</div>

</div>

<div class="sect1">

## Options

<div class="sectionbody">

| Option                | Description                                                                                                                                                             |
| --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Transform name        | Name of the transform.                                                                                                                                                  |
| Reference rows origin | Specify the transform that produces the reference rows. It’s a Stream with original rows (rows that you want to compare the new rows to).                               |
| Compare rows origin   | Specify the transform that produces the compare rows. It’s a Stream with new rows                                                                                       |
| Flag fieldname        | Specify the name of the flag field on the output stream.                                                                                                                |
| Keys to match         | Specify fields containing the keys on which to match. Click "Get key fields" to insert all of the fields from the reference rows                                        |
| Values to compare     | Specify fields contaning the values to compare. Click "Get value fields" to insert all of the fields from the compare rows. Key fields do not need to be repeated here. |

</div>

</div>

</div>

<div id="footer">

<div id="footer-text">

Last updated 2025-09-04 18:22:37 +0200

</div>

</div>
