<div id="header">

# <span class="image image-doc-icon">![MongoDB Input transform Icon](../assets/images/transforms/icons/mongodb-input.svg)</span> MongoDB Input

</div>

<div id="content">

<div id="preamble">

<div class="sectionbody">

<table>
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="content">
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MongoDB Input transform enables you to retrieve <a href="http://docs.mongodb.org/manual/reference/glossary/">documents</a> or <a href="http://docs.mongodb.org/manual/reference/glossary/">records</a> from a collection within MongoDB.</p>
</div>
<div class="paragraph">
<p>For additional information about MongoDB, see the MongoDB <a href="http://www.mongodb.org/">documentation</a>.</p>
</div>
</div>
</div>
</div></td>
<td><div class="content">
<div class="sect1">
<h2 id="_supported_engines">Supported Engines</h2>
<div class="sectionbody">
<table>
<tbody>
<tr class="odd">
<td><p>Hop Engine</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/check_mark.svg" alt="Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="even">
<td><p>Spark</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/check_mark.svg" alt="Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="odd">
<td><p>Flink</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/check_mark.svg" alt="Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
<tr class="even">
<td><p>Dataflow</p></td>
<td><div class="content">
<div class="paragraph">
<p><span class="image"><img src="../assets/images/check_mark.svg" alt="Supported" width="24" /></span></p>
</div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div></td>
</tr>
</tbody>
</table>

</div>

</div>

<div class="sect1">

## Options

<div class="sectionbody">

<div class="sect2">

### General

<div class="paragraph">

Transform name : Specify the unique name of the MongoDB Input transform in the pipeline. Preview button: Display the rows generated by this transform. Enter the maximum number of records that you want to preview, then click OK. The preview data appears in the Examine preview data window.

</div>

</div>

<div class="sect2">

### Input options tab

<div class="paragraph">

The Input options tab enables you to specify which connection and collection you want to retrieve information from.

</div>

<div class="paragraph">

Enter the following information in the Input options fields:

</div>

| Option             | Definition                                                                                                                                         |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| MongoDB Connection | the [MongoDB connection](metadata-types/mongodb-connection.QpcxHvVKJb) to use for this MongoDB Input transform.                                    |
| Collection         | Name of the collection to retrieve data from. Click Get collections to populate the drop-down menu with a list of collections within the database. |

</div>

<div class="sect2">

### Query tab

<div class="paragraph">

The Query tab enables you to refine read requests. This tab operates in two different query modes:

</div>

<div class="ulist">

  - **Query expression** mode (default)

  - **Aggregation pipeline specification** mode.

</div>

<div class="paragraph">

The **Query is aggregation pipeline** option toggles between these two modes. The Query expression uses MongoDB’s JSON-like query language with query operators to perform [query operations](https://docs.mongodb.com/manual/reference/operator/query/). The **Aggregation pipeline specification** field uses MongoDB’s [aggregation framework](http://docs.mongodb.org/manual/applications/aggregation/) to transform and combine documents in a collection. An aggregation pipeline connects several [pipeline expressions](https://docs.mongodb.com/manual/core/aggregation-pipeline/#pipeline-expressions) together, with the output of the previous expression becoming the input for the next.

</div>

<div class="paragraph">

Enter the following information in the Query fields:

</div>

| Fields/Option                             | Definition                                                                                                                                                                                                                                                                                                                                    |
| ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Query expression (JSON)                   | Enter a query expression in this field to limit the output.                                                                                                                                                                                                                                                                                   |
| Aggregation pipeline specification (JSON) | Select the **Query is aggregation pipeline** option to display the **Aggregation pipeline specification (JSON)** field. Then enter a pipeline expression to perform aggregations or selections. The method name, including the collection name of the database you selected in the Input Options tab, appears after the label for this field. |
| Query is aggregation pipeline             | Select this option to use the aggregation pipeline framework.                                                                                                                                                                                                                                                                                 |
| Execute for each row                      | Select this option to perform the query on each row of data.                                                                                                                                                                                                                                                                                  |
| Fields expression (JSON)                  | Enter an argument to control the projection (fields to return) from a query. If empty, all fields are returned. This field is only available for query expressions.                                                                                                                                                                           |

</div>

<div class="sect2">

### Fields tab

<div class="paragraph">

Use the Fields tab to define properties for exported fields. The Fields tab operates in two different modes:

</div>

<div class="olist arabic">

1.  including all fields in a single JSON field

2.  including selected fields in the output.

</div>

<div class="paragraph">

If you store the output in a single JSON field, you can parse this JSON using the JSON Input transform, or by using a User Defined Java Class transform.

</div>

<div class="paragraph">

**Note:** All fields in the Fields tab except the Name of JSON output field are inactive when the Output single JSON field is selected. When the Output single JSON field is not selected, the Name of JSON output field is inactive.

</div>

<div class="paragraph">

General options:

</div>

<div class="ulist">

  - **The Get fields button**: Click it to generate a sample set of documents. You can edit the list of field names, paths, and data type for each field in the sample.

  - **Output single JSON field**: Specify that the query results in a single JSON field with the String data type (default).

  - **Name of JSON output field**: Specify the field name of containing the JSON output from the server.

</div>

<div class="paragraph">

Enter the following information in the table if you want to output distinct fields:

</div>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>#</p></td>
<td><p>The order of this entry in the list.</p></td>
</tr>
<tr class="even">
<td><p>Name</p></td>
<td><p>The name of the field based on the value in the Path field. The name that appears here maps the name of the field as it appears in the pipeline with the field that appears in the MongoDB database. You can edit the name.</p></td>
</tr>
<tr class="odd">
<td><p>Path</p></td>
<td><div class="content">
<div class="paragraph">
<p>Indicates the JSON path of the field in MongoDB.</p>
</div>
<div class="paragraph">
<p>If the path shown is an array, you can specify a specific element of the array by passing it the key value in the bracketed part of the array.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li><p><code>$.emails[0]</code> indicates that you want the result to display the first value in the array.</p></li>
<li><p>To display all array values, use the asterisk as the key, like this <code>$.email[*]</code>.</p></li>
<li><p>If the array contains records, and not just strings, you can specify that you want to display the record like this: <code>$.emails[].sender</code>.</p></li>
</ul>
</div>
</div></td>
</tr>
<tr class="even">
<td><p>Type</p></td>
<td><p>Indicates the data type.</p></td>
</tr>
<tr class="odd">
<td><p>Indexed values</p></td>
<td><p>Specify a comma-separated list of legal values for String fields. When you specify values in this field, the Hop indexed data type is applied to the data. If no values are specified, the String data type is applied. Usually, you will only need to modify this field if you are using Weka metadata for nominal fields.</p></td>
</tr>
<tr class="even">
<td><p>Sample: array min: max index</p></td>
<td><p>Indicates minimum and maximum values for the index in the sampled documents.</p></td>
</tr>
<tr class="odd">
<td><p>Sample: #occur/#docs</p></td>
<td><p>Indicates how often the field occurs and the number of documents processed.</p></td>
</tr>
<tr class="even">
<td><p>Sample: disparate types</p></td>
<td><p>Indicates if different data types populate the same field in the sampled documents. When several documents are sampled and the same field contain different data types, the Sample: disparate types field is populated with a Y and the Type field displays the String data type. The Hop type for the field is set to the String data type, for different output value types.</p></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>

<div class="sect1">

## Examples

<div class="sectionbody">

<div class="paragraph">

The following sections contain examples of query expressions and aggregate pipelines.

</div>

<div class="sect2">

### Query expression

<div class="paragraph">

MongoDB allows you to select and filter documents in a collection using specific fields and values. The [MongoDB Extended JSON](http://docs.mongodb.org/manual/reference/mongodb-extended-json/) documentation details how to use queries. Apache Hop supports only the features discussed on this page.

</div>

<div class="paragraph">

The following table displays some examples of the syntax and structure of the queries you can use to request data from MongoDB:

</div>

| Query expression                                                     | Description                                                                                           |
| -------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| `{ name : "MongoDB" }`                                               | Queries all values where the name field has a value equal to MongoDB.                                 |
| `{ name : { '$regex' : "m.*", '$options' : "i" } }`                  | Uses a regular expression to find name fields starting with m, case insensitive.                      |
| `{ name : { '$gt' : "M" } }`                                         | Searches all strings greater than M.                                                                  |
| `{ name : { '$lte' : "T" } }`                                        | Searches all strings less than or equal to T.                                                         |
| `{ name : { '$in' : [ "MongoDB", "MySQL" ] } }`                      | Finds all names that are either MongoDB or MySQL (Reference).                                         |
| `{ name : { '$nin' : [ "MongoDB", "MySQL" ] } }`                     | Finds all names that are not either MongoDB or MySQL, or where the field is not set .                 |
| `{ created_at : { $gte : { $date : "2014-12-31T00:00:00.000Z" } } }` | Finds all created\_at documents that are greater than or equal to the specified UTC date.             |
| `{ $where : "this.count == 1" }`                                     | Uses JavaScript to evaluate a condition.                                                              |
| `{ $query: {}, $orderby: { age : -1 } }`                             | Returns all documents in the collection named collection sorted by the age field in descending order. |

</div>

<div class="sect2">

### Aggregate pipeline

<div class="paragraph">

MongoDB allows you to select and filter documents using the [aggregation](http://docs.mongodb.org/manual/tutorial/aggregation-examples/) pipeline framework. The Aggregation page in the MongoDB documentation provides additional examples of function calls.

</div>

<div class="paragraph">

The following table displays some examples of the query syntax and structure you can use to request data from MongoDB:

</div>

| Query expression                                                                                                                                     | Description                                                                                                                                                                                          |
| ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `{ $match : {state : "FL", city : "ORLANDO" } }, {$sort : {pop : -1 } }`                                                                             | Returns all fields from all documents where the state field has a value of FL and the city field has a value of ORLANDO. The returned documents will be sorted by the pop field in descending order. |
| `{ $group : { _id: "$state"} }, { $sort : { _id : 1 } }`                                                                                             | Returns one field named \_id containing the distinct values for state in ascending order. This is similar to the SQL statement SELECT DISTINCT state AS \_id FROM collection ORDER BY state ASC.     |
| `{ $match : {state : "FL" } }, { $group: {_id: "$city" , pop: { $sum: "$pop" } } }, { $sort: { pop: -1 } }, { $project: {_id : 0, city : "$_id" } }` | Returns all documents where the state field has a value of FL, aggregates all values of pop for each city, sorts by population descending, and returns one field named city.                         |
| `{ $unwind : "$result" }`                                                                                                                            | Peels off the elements of an array individually, and returns one document for each element of the array.                                                                                             |

</div>

</div>

</div>

</div>

<div id="footer">

<div id="footer-text">

Last updated 2025-09-04 18:22:40 +0200

</div>

</div>
